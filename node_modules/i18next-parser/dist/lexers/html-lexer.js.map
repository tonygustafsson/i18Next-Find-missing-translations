{"version":3,"file":"html-lexer.js","names":["BaseLexer","cheerio","HTMLLexer","options","attr","optionAttr","content","that","$","load","each","index","node","$node","keys","attribs","split","JSON","parse","key","replace","text","push"],"sources":["../../src/lexers/html-lexer.js"],"sourcesContent":["import BaseLexer from './base-lexer.js'\nimport cheerio from 'cheerio'\n\nexport default class HTMLLexer extends BaseLexer {\n  constructor(options = {}) {\n    super(options)\n\n    this.attr = options.attr || 'data-i18n'\n    this.optionAttr = options.optionAttr || 'data-i18n-options'\n  }\n\n  extract(content) {\n    const that = this\n    const $ = cheerio.load(content)\n    $(`[${that.attr}]`).each((index, node) => {\n      const $node = cheerio.load(node)\n\n      // the attribute can hold multiple keys\n      const keys = node.attribs[that.attr].split(';')\n      let options = node.attribs[that.optionAttr]\n\n      if (options) {\n        try {\n          options = JSON.parse(options)\n        } finally {\n        }\n      }\n\n      for (let key of keys) {\n        // remove any leading [] in the key\n        key = key.replace(/^\\[[a-zA-Z0-9_-]*\\]/, '')\n\n        // if empty grab innerHTML from regex\n        key = key || $node.text()\n\n        if (key) {\n          this.keys.push({ ...options, key })\n        }\n      }\n    })\n\n    return this.keys\n  }\n}\n"],"mappings":"s8GAAA,OAAOA,SAAS,MAAM,iBAAiB;AACvC,OAAOC,OAAO,MAAM,SAAS;;AAERC,SAAS;EAC5B,qBAA0B,eAAdC,OAAO,uEAAG,CAAC,CAAC;IACtB,0BAAMA,OAAO;;IAEb,MAAKC,IAAI,GAAGD,OAAO,CAACC,IAAI,IAAI,WAAW;IACvC,MAAKC,UAAU,GAAGF,OAAO,CAACE,UAAU,IAAI,mBAAmB;EAC7D,CAAC;;IAED,iBAAQC,OAAO,EAAE;MACf,IAAMC,IAAI,GAAG,IAAI;MACjB,IAAMC,CAAC,GAAGP,OAAO,CAACQ,IAAI,CAACH,OAAO,CAAC;MAC/BE,CAAC,YAAKD,IAAI,CAACH,IAAI,OAAI,CAACM,IAAI,CAAC,UAACC,KAAK,EAAEC,IAAI,EAAK;QACxC,IAAMC,KAAK,GAAGZ,OAAO,CAACQ,IAAI,CAACG,IAAI,CAAC;;QAEhC;QACA,IAAME,IAAI,GAAGF,IAAI,CAACG,OAAO,CAACR,IAAI,CAACH,IAAI,CAAC,CAACY,KAAK,CAAC,GAAG,CAAC;QAC/C,IAAIb,OAAO,GAAGS,IAAI,CAACG,OAAO,CAACR,IAAI,CAACF,UAAU,CAAC;;QAE3C,IAAIF,OAAO,EAAE;UACX,IAAI;YACFA,OAAO,GAAGc,IAAI,CAACC,KAAK,CAACf,OAAO,CAAC;UAC/B,CAAC,SAAS;UACV;QACF,CAAC;;UAEeW,IAAI,aAApB,oDAAsB,KAAbK,GAAG;YACV;YACAA,GAAG,GAAGA,GAAG,CAACC,OAAO,CAAC,qBAAqB,EAAE,EAAE,CAAC;;YAE5C;YACAD,GAAG,GAAGA,GAAG,IAAIN,KAAK,CAACQ,IAAI,EAAE;;YAEzB,IAAIF,GAAG,EAAE;cACP,MAAI,CAACL,IAAI,CAACQ,IAAI,iCAAMnB,OAAO,SAAEgB,GAAG,EAAHA,GAAG,IAAG;YACrC;UACF,CAAC;MACH,CAAC,CAAC;;MAEF,OAAO,IAAI,CAACL,IAAI;IAClB,CAAC,wBAvCoCd,SAAS,WAA3BE,SAAS"}