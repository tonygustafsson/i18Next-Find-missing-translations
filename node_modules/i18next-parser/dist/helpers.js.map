{"version":3,"file":"helpers.js","names":["pathToFileURL","build","rmSync","yaml","builtinModules","dotPathToHash","entry","target","options","conflict","duplicate","path","keyWithNamespace","suffix","separator","key","substring","indexOf","length","namespace","defaultValue","newValue","value","locale","endsWith","slice","segments","split","inner","i","segment","undefined","lastSegment","oldValue","customValueTemplate","entries","Object","forEach","valueEntry","replace","mergeHashes","source","resetValues","old","reset","mergeCount","pullCount","oldCount","resetCount","keepRemoved","pluralSeparator","hasNestedEntries","Array","isArray","nested","keys","resetAndFlag","isPlural","singularKey","getSingularForm","pluralMatch","contextRegex","contextMatch","test","rawKey","hasRelatedPluralKey","transferValues","sourceValue","targetValue","pluralSuffixes","some","pluralRegex","RegExp","getPluralSuffixPosition","len","makeDefaultSort","defaultSort","key1","key2","singularKey1","singularKey2","localeCompare","esConfigLoader","filepath","tsConfigLoader","outfile","absWorkingDir","process","cwd","entryPoints","write","platform","bundle","format","sourcemap","external","map","mod","config","yamlConfigLoader","content","load","unescape","text","matchHtmlEntity","htmlEntities","unescapeHtmlEntity","m"],"sources":["../src/helpers.js"],"sourcesContent":["import { pathToFileURL } from 'url'\nimport { build } from 'esbuild'\nimport { rmSync } from 'fs'\nimport yaml from 'js-yaml'\nimport { builtinModules } from 'module'\n\n/**\n * Take an entry for the Parser and turn it into a hash,\n * turning the key path 'foo.bar' into an hash {foo: {bar: \"\"}}\n * The generated hash can be merged with an optional `target`.\n * @returns An `{ target, duplicate, conflict }` object. `target` is the hash\n * that was passed as an argument or a new hash if none was passed. `duplicate`\n * indicates whether the entry already existed in the `target` hash. `conflict`\n * is `\"key\"` if a parent of the key was already mapped to a string (e.g. when\n * merging entry {one: {two: \"bla\"}} with target {one: \"bla\"}) or the key was\n * already mapped to a map (e.g. when merging entry {one: \"bla\"} with target\n * {one: {two: \"bla\"}}), `\"value\"` if the same key already exists with a\n * different value, or `false`.\n */\nfunction dotPathToHash(entry, target = {}, options = {}) {\n  let conflict = false\n  let duplicate = false\n  let path = entry.keyWithNamespace\n  if (options.suffix) {\n    path += options.suffix\n  }\n\n  const separator = options.separator || '.'\n\n  const key = entry.keyWithNamespace.substring(\n    entry.keyWithNamespace.indexOf(separator) + separator.length,\n    entry.keyWithNamespace.length\n  )\n\n  // There is no key to process so we return an empty object\n  if (!key) {\n    if (!target[entry.namespace]) {\n      target[entry.namespace] = {}\n    }\n    return { target, duplicate, conflict }\n  }\n\n  const defaultValue =\n    entry[`defaultValue${options.suffix}`] || entry.defaultValue || ''\n\n  let newValue =\n    typeof options.value === 'function'\n      ? options.value(options.locale, entry.namespace, key, defaultValue)\n      : options.value || defaultValue\n\n  if (path.endsWith(separator)) {\n    path = path.slice(0, -separator.length)\n  }\n\n  const segments = path.split(separator)\n  let inner = target\n  for (let i = 0; i < segments.length - 1; i += 1) {\n    const segment = segments[i]\n    if (segment) {\n      if (typeof inner[segment] === 'string') {\n        conflict = 'key'\n      }\n      if (inner[segment] === undefined || conflict) {\n        inner[segment] = {}\n      }\n      inner = inner[segment]\n    }\n  }\n\n  const lastSegment = segments[segments.length - 1]\n  const oldValue = inner[lastSegment]\n  if (oldValue !== undefined && oldValue !== newValue) {\n    if (typeof oldValue !== typeof newValue) {\n      conflict = 'key'\n    } else if (oldValue !== '') {\n      if (newValue === '') {\n        newValue = oldValue\n      } else {\n        conflict = 'value'\n      }\n    }\n  }\n  duplicate = oldValue !== undefined || conflict !== false\n\n  if (options.customValueTemplate) {\n    inner[lastSegment] = {}\n\n    const entries = Object.entries(options.customValueTemplate)\n    entries.forEach((valueEntry) => {\n      if (valueEntry[1] === '${defaultValue}') {\n        inner[lastSegment][valueEntry[0]] = newValue\n      } else {\n        inner[lastSegment][valueEntry[0]] =\n          entry[valueEntry[1].replace(/\\${(\\w+)}/, '$1')] || ''\n      }\n    })\n  } else {\n    inner[lastSegment] = newValue\n  }\n\n  return { target, duplicate, conflict }\n}\n\n/**\n * Takes a `source` hash and makes sure its value\n * is pasted in the `target` hash, if the target\n * hash has the corresponding key (or if `options.keepRemoved` is true).\n * @returns An `{ old, new, mergeCount, pullCount, oldCount, reset, resetCount }` object.\n * `old` is a hash of values that have not been merged into `target`.\n * `new` is `target`. `mergeCount` is the number of keys merged into\n * `new`, `pullCount` is the number of context and plural keys added to\n * `new` and `oldCount` is the number of keys that were either added to `old` or\n * `new` (if `options.keepRemoved` is true and `target` didn't have the corresponding\n * key) and `reset` is the keys that were reset due to not matching default values,\n *  and `resetCount` which is the number of keys reset.\n */\nfunction mergeHashes(source, target, options = {}, resetValues = {}) {\n  let old = {}\n  let reset = {}\n  let mergeCount = 0\n  let pullCount = 0\n  let oldCount = 0\n  let resetCount = 0\n\n  const keepRemoved = options.keepRemoved || false\n  const pluralSeparator = options.pluralSeparator || '_'\n\n  for (const key in source) {\n    const hasNestedEntries =\n      typeof target[key] === 'object' && !Array.isArray(target[key])\n\n    if (hasNestedEntries) {\n      const nested = mergeHashes(\n        source[key],\n        target[key],\n        options,\n        resetValues[key]\n      )\n      mergeCount += nested.mergeCount\n      pullCount += nested.pullCount\n      oldCount += nested.oldCount\n      resetCount += nested.resetCount\n      if (Object.keys(nested.old).length) {\n        old[key] = nested.old\n      }\n      if (Object.keys(nested.reset).length) {\n        reset[key] = nested.reset\n      }\n    } else if (target[key] !== undefined) {\n      if (typeof source[key] !== 'string' && !Array.isArray(source[key])) {\n        old[key] = source[key]\n        oldCount += 1\n      } else {\n        if (\n          (options.resetAndFlag &&\n            !isPlural(key) &&\n            typeof source[key] === 'string' &&\n            source[key] !== target[key]) ||\n          resetValues[key]\n        ) {\n          old[key] = source[key]\n          oldCount += 1\n          reset[key] = true\n          resetCount += 1\n        } else {\n          target[key] = source[key]\n          mergeCount += 1\n        }\n      }\n    } else {\n      // support for plural in keys\n      const singularKey = getSingularForm(key, pluralSeparator)\n      const pluralMatch = key !== singularKey\n\n      // support for context in keys\n      const contextRegex = /_([^_]+)?$/\n      const contextMatch = contextRegex.test(singularKey)\n      const rawKey = singularKey.replace(contextRegex, '')\n\n      if (\n        (contextMatch && target[rawKey] !== undefined) ||\n        (pluralMatch &&\n          hasRelatedPluralKey(`${singularKey}${pluralSeparator}`, target))\n      ) {\n        target[key] = source[key]\n        pullCount += 1\n      } else {\n        if (keepRemoved) {\n          target[key] = source[key]\n        } else {\n          old[key] = source[key]\n        }\n        oldCount += 1\n      }\n    }\n  }\n\n  return {\n    old,\n    new: target,\n    mergeCount,\n    pullCount,\n    oldCount,\n    reset,\n    resetCount,\n  }\n}\n\n/**\n * Merge `source` into `target` by merging nested dictionaries.\n */\nfunction transferValues(source, target) {\n  for (const key in source) {\n    const sourceValue = source[key]\n    const targetValue = target[key]\n    if (\n      typeof sourceValue === 'object' &&\n      typeof targetValue === 'object' &&\n      !Array.isArray(sourceValue)\n    ) {\n      transferValues(sourceValue, targetValue)\n    } else {\n      target[key] = sourceValue\n    }\n  }\n}\n\nconst pluralSuffixes = ['zero', 'one', 'two', 'few', 'many', 'other']\n\nfunction isPlural(key) {\n  return pluralSuffixes.some((suffix) => key.endsWith(suffix))\n}\n\nfunction hasRelatedPluralKey(rawKey, source) {\n  return pluralSuffixes.some(\n    (suffix) => source[`${rawKey}${suffix}`] !== undefined\n  )\n}\n\nfunction getSingularForm(key, pluralSeparator) {\n  const pluralRegex = new RegExp(\n    `(\\\\${pluralSeparator}(?:zero|one|two|few|many|other))$`\n  )\n\n  return key.replace(pluralRegex, '')\n}\n\nfunction getPluralSuffixPosition(key) {\n  for (let i = 0, len = pluralSuffixes.length; i < len; i++) {\n    if (key.endsWith(pluralSuffixes[i])) return i\n  }\n\n  return -1\n}\n\nfunction makeDefaultSort(pluralSeparator) {\n  return function defaultSort(key1, key2) {\n    const singularKey1 = getSingularForm(key1, pluralSeparator)\n    const singularKey2 = getSingularForm(key2, pluralSeparator)\n\n    if (singularKey1 === singularKey2) {\n      return getPluralSuffixPosition(key1) - getPluralSuffixPosition(key2)\n    }\n\n    return singularKey1.localeCompare(singularKey2)\n  }\n}\n\nasync function esConfigLoader(filepath) {\n  return (await import(pathToFileURL(filepath))).default\n}\n\nasync function tsConfigLoader(filepath) {\n  const outfile = filepath + '.bundle.js'\n  await build({\n    absWorkingDir: process.cwd(),\n    entryPoints: [filepath],\n    outfile,\n    write: true,\n    target: ['node14.18', 'node16'],\n    platform: 'node',\n    bundle: true,\n    format: 'esm',\n    sourcemap: 'inline',\n    external: [\n      ...builtinModules,\n      ...builtinModules.map((mod) => 'node:' + mod),\n    ],\n  })\n  const config = await esConfigLoader(outfile)\n  rmSync(outfile)\n  return config\n}\n\nfunction yamlConfigLoader(filepath, content) {\n  return yaml.load(content)\n}\n\n// unescape common html entities\n// code from react-18next taken from\n// https://github.com/i18next/react-i18next/blob/d3247b5c232f5d8c1a154fe5dd0090ca88c82dcf/src/unescape.js\nfunction unescape(text) {\n  const matchHtmlEntity =\n    /&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g\n  const htmlEntities = {\n    '&amp;': '&',\n    '&#38;': '&',\n    '&lt;': '<',\n    '&#60;': '<',\n    '&gt;': '>',\n    '&#62;': '>',\n    '&apos;': \"'\",\n    '&#39;': \"'\",\n    '&quot;': '\"',\n    '&#34;': '\"',\n    '&nbsp;': ' ',\n    '&#160;': ' ',\n    '&copy;': '©',\n    '&#169;': '©',\n    '&reg;': '®',\n    '&#174;': '®',\n    '&hellip;': '…',\n    '&#8230;': '…',\n    '&#x2F;': '/',\n    '&#47;': '/',\n  }\n\n  const unescapeHtmlEntity = (m) => htmlEntities[m]\n\n  return text.replace(matchHtmlEntity, unescapeHtmlEntity)\n}\n\nexport {\n  dotPathToHash,\n  mergeHashes,\n  transferValues,\n  hasRelatedPluralKey,\n  getSingularForm,\n  getPluralSuffixPosition,\n  makeDefaultSort,\n  esConfigLoader,\n  tsConfigLoader,\n  yamlConfigLoader,\n  unescape,\n}\n"],"mappings":"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"}